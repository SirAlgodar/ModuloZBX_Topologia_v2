/* Estilos básicos do módulo Mapa Backbone */
* { box-sizing: border-box; }
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; margin: 0; color: #222; }
.app-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid #e5e7eb; background: #fff; }
.header-actions { font-size: 12px; color: #666; }
.app-title { display: inline-flex; align-items: center; gap: 10px; font-weight: 600; }
.logo-icon { width: 24px; height: 24px; border-radius: 6px; background: linear-gradient(135deg, #6366f1, #22d3ee); display: inline-block; }

.tabs { display: flex; align-items: center; justify-content: space-between; padding: 8px 16px; border-bottom: 1px solid #e5e7eb; background: #f9fafb; }
.tabs-left, .tabs-right { display: flex; align-items: center; gap: 8px; }

.tab-button { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #e5e7eb; background: #fff; cursor: pointer; border-radius: 10px; color: #111827; transition: background-color 160ms ease, box-shadow 160ms ease, transform 120ms ease; }
.tab-button.active { background: #eef2ff; color: #111827; border-color: #6366f1; box-shadow: 0 1px 2px rgba(99,102,241,0.15), inset 0 1px 0 rgba(255,255,255,0.4); }
.tab-button:hover { background: #f3f4f6; }
.tab-button:active { transform: translateY(1px); }

.config-button { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 10px; background: #fff; cursor: pointer; color: #111827; }
.config-menu { position: relative; }
.config-dropdown { position: absolute; right: 0; top: calc(100% + 6px); min-width: 240px; padding: 6px; border: 1px solid #e5e7eb; border-radius: 12px; background: #fff; box-shadow: 0 8px 24px rgba(0,0,0,0.12); display: none; z-index: 20; }
.config-dropdown.open { display: block; animation: fadeIn 180ms ease forwards; }
.dropdown-item { display: flex; align-items: center; gap: 10px; width: 100%; padding: 10px 10px; border-radius: 8px; background: transparent; border: none; color: #111827; text-align: left; cursor: pointer; }
.dropdown-item:hover { background: #f3f4f6; }

.tab-content { padding: 8px 16px; }
.tab-panel { display: none; opacity: 0; transform: translateY(4px); transition: opacity 180ms ease, transform 180ms ease; }
.tab-panel.active { display: block; opacity: 1; transform: translateY(0); }

.panel { display: grid; grid-template-columns: 1fr 360px; gap: 12px; height: calc(100vh - 140px); }
.map { height: 100%; width: 100%; }
.leaflet-container { min-height: 300px; background: #f8fafc; }
.leaflet-draw-toolbar a { border-radius: 6px; }
.leaflet-bar a, .leaflet-bar a:hover { background: #fff; }
.editor-panel { border: 1px solid #e5e7eb; padding: 12px; overflow-y: auto; border-radius: 12px; background: #fff; box-shadow: 0 4px 16px rgba(0,0,0,0.08); }
.editor-panel h2, .editor-panel h3 { margin: 0 0 8px; }
label { display: block; margin: 8px 0; font-size: 14px; }

/* Inputs modernos */
input, select { width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 10px; transition: border-color 140ms ease, box-shadow 140ms ease; }
input:focus, select:focus { outline: none; border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99,102,241,0.15); }

/* Botões modernos e ações */
.layer-controls button, .form-actions button { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 10px; background: #fff; cursor: pointer; color: #111827; transition: background-color 160ms ease, box-shadow 160ms ease, transform 120ms ease; }
.layer-controls button.primary, .form-actions button.primary { background: #4f46e5; color: #fff; border-color: #4f46e5; }
.layer-controls button:hover, .form-actions button:hover { background: #f3f4f6; }
.layer-controls button.primary:hover, .form-actions button.primary:hover { background: #4338ca; }
.layer-controls button:active, .form-actions button:active { transform: translateY(1px); }

/* Container de configuração */
.config-container { max-width: 720px; margin: 0 auto; border: 1px solid #e5e7eb; border-radius: 12px; padding: 18px; background: #fff; box-shadow: 0 4px 16px rgba(0,0,0,0.06); }
.config-container h2 { margin-top: 0; display: flex; align-items: center; gap: 10px; }

/* Toast */
.toast-container { position: fixed; right: 16px; bottom: 16px; z-index: 100; display: flex; flex-direction: column; gap: 8px; }
.toast { min-width: 280px; max-width: 420px; padding: 12px 14px; border-radius: 12px; color: #111827; background: #fff; border: 1px solid #e5e7eb; box-shadow: 0 8px 24px rgba(0,0,0,0.12); display: flex; align-items: center; gap: 10px; animation: slideUp 220ms ease; }
.toast.success { border-color: #10b981; }
.toast.error { border-color: #ef4444; }
.toast.info { border-color: #3b82f6; }
.toast .icon { width: 20px; height: 20px; display: inline-flex; align-items: center; justify-content: center; }

@keyframes slideUp { from { transform: translateY(8px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

/* Responsividade */
@media (max-width: 900px) {
  .tabs { flex-wrap: wrap; gap: 10px; }
  .panel { grid-template-columns: 1fr; height: auto; }
  .editor-panel { order: 2; }
}
input[type="text"], input[type="number"], select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; }
fieldset { margin: 12px 0; padding: 8px; border: 1px solid #e5e7eb; border-radius: 6px; }
.form-actions { display: flex; gap: 8px; margin-top: 10px; }
button { padding: 8px 12px; border-radius: 6px; border: 1px solid #ddd; background: #fff; cursor: pointer; }
button.primary { background: #2563eb; color: white; border-color: #2563eb; }
button.danger { background: #dc2626; color: white; border-color: #dc2626; }
.items-checkboxes { display: grid; grid-template-columns: 1fr; gap: 6px; }
.layer-actions { display: flex; gap: 8px; }
.topology-container { padding: 12px; }
.config-container { padding: 12px; }
.topology-controls { display: flex; gap: 12px; align-items: center; margin-bottom: 8px; }
.topology-view { border: 1px solid #e5e7eb; border-radius: 6px; min-height: 300px; padding: 12px; background: #fff; }
.top-node { padding: 6px 8px; border: 1px solid #ddd; border-radius: 6px; display: inline-block; margin: 4px; background: #f8fafc; }
.link-info { font-size: 12px; color: #666; }
.admin-warning { padding: 10px; border: 1px solid #f59e0b; background: #fffbeb; color: #92400e; border-radius: 6px; }
.hidden { display: none; }
.tooltip { position: absolute; background: #111827; color: #fff; padding: 6px 8px; border-radius: 6px; font-size: 12px; pointer-events: none; z-index: 9999; }

/* Legend */
.legend { position: absolute; top: 12px; left: 12px; background: #fff; border: 1px solid #e5e7eb; border-radius: 6px; padding: 8px; font-size: 12px; z-index: 500; }
.legend-item { display: flex; gap: 6px; align-items: center; margin: 4px 0; }
.legend-color { width: 12px; height: 12px; border-radius: 2px; }
.config-container h2 { margin-top: 0; }
.config-container small { color: #666; }
/* Incidentes ativos */
.incident-panel { display: block; margin-bottom: 12px; }
.incident-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
.add-line-btn { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #4f46e5; border-radius: 10px; background: #4f46e5; color: #fff; cursor: pointer; }
.add-line-btn:hover { background: #4338ca; }
.incident-table { width: 100%; border-collapse: collapse; }
.incident-table th, .incident-table td { padding: 10px; border-bottom: 1px solid #e5e7eb; text-align: left; }
.incident-table th { user-select: none; cursor: pointer; color: #374151; }
.incident-table tr:hover { background: #f9fafb; }
.status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 8px; border-radius: 999px; font-size: 12px; }
.status-ok { background: #ecfdf5; color: #065f46; border: 1px solid #10b981; }
.status-warn { background: #fffbeb; color: #92400e; border: 1px solid #f59e0b; }
.status-crit { background: #fee2e2; color: #991b1b; border: 1px solid #ef4444; }
.priority-low { color: #6b7280; }
.priority-med { color: #2563eb; }
.priority-high { color: #ef4444; font-weight: 600; }

/* Modal */
.modal { position: fixed; inset: 0; display: none; z-index: 100; }
.modal.open { display: block; }
.modal-backdrop { position: absolute; inset: 0; background: rgba(17,24,39,0.36); }
.modal-content { position: relative; margin: 8vh auto 0; background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; width: 92%; max-width: 640px; box-shadow: 0 12px 32px rgba(0,0,0,0.18); animation: fadeIn 180ms ease; }
.modal-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid #f3f4f6; }
.modal-body { padding: 12px 16px; }
.modal-actions { display: flex; gap: 8px; justify-content: flex-end; padding: 12px 16px; border-top: 1px solid #f3f4f6; }
.modal-close { border: none; background: transparent; cursor: pointer; }
.modal .primary { background: #4f46e5; color: #fff; border: 1px solid #4f46e5; border-radius: 10px; padding: 8px 12px; }
.modal .secondary { background: #fff; color: #111827; border: 1px solid #e5e7eb; border-radius: 10px; padding: 8px 12px; }

/* Ocultação do editor quando não está editando */
#line-editor-container.hidden { display: none; }
.legend-item { display: grid; grid-template-columns: 20px 24px 1fr 64px; align-items: center; gap: 8px; padding: 6px 0; }
.legend-color { width: 20px; height: 12px; border-radius: 3px; display: inline-block; }
.layer-order-controls { display: inline-flex; gap: 6px; justify-self: end; }
.order-btn { border: 1px solid #e5e7eb; background: #fff; border-radius: 8px; padding: 4px 8px; cursor: pointer; }
.order-btn:hover { background: #f3f4f6; }

/* Centro Inicial do Mapa */
.mapcenter-preview { margin-top: 12px; }
.preview-map { height: 220px; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden; }